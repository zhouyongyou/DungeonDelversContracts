# 🚀 DungeonDelvers 版本升級檢查清單

**版本**: V__ -> V__  
**日期**: ____-__-__  
**負責人**: _______

## 📋 升級前準備

### 1. 備份現有合約
- [ ] 確認所有合約已提交到 Git
- [ ] 創建當前版本的 Git tag
- [ ] 備份生產環境配置文件
- [ ] 記錄當前合約地址和區塊高度

### 2. 代碼審查
- [ ] 完成內部代碼審查
- [ ] 運行所有測試套件
- [ ] 檢查 gas 優化建議
- [ ] 確認無安全漏洞

## 🔧 部署流程

### 3. 合約編譯
- [ ] 清理舊的編譯文件：`npm run clean`
- [ ] 編譯新合約：`npm run compile`
- [ ] 確認無編譯錯誤或警告

### 4. 測試網部署（可選）
- [ ] 部署到 BSC 測試網
- [ ] 執行功能測試
- [ ] 確認合約交互正常

### 5. 主網部署
- [ ] 執行部署腳本：`npm run deploy:v__`
- [ ] 記錄新合約地址
- [ ] 驗證部署交易成功
- [ ] 等待足夠的區塊確認

### 6. 合約驗證
- [ ] 在 BSCScan 驗證所有合約
- [ ] 確認 ABI 正確上傳
- [ ] 測試讀寫功能

## 🔄 配置更新

### 7. 更新 V21 配置
- [ ] 編輯 `config/v21-config.js`
- [ ] 更新版本號和日期
- [ ] 添加新合約地址
- [ ] 記錄變更內容

### 8. 同步配置到所有項目
- [ ] 執行：`npm run v21:sync`
- [ ] 檢查同步報告
- [ ] 確認所有項目更新成功

### 9. 驗證配置一致性
- [ ] 執行：`npm run v21:check`
- [ ] 確認無配置不匹配
- [ ] 處理任何警告或錯誤

## 🧪 集成測試

### 10. 前端測試
- [ ] 測試 NFT 鑄造功能
- [ ] 測試價格顯示正確
- [ ] 測試合約交互功能
- [ ] 測試錢包連接

### 11. 後端測試
- [ ] 測試 metadata API
- [ ] 測試配置載入
- [ ] 檢查日誌無錯誤

### 12. 子圖測試
- [ ] 重新部署 subgraph
- [ ] 等待索引完成
- [ ] 測試查詢功能

## 📝 文檔更新

### 13. 更新文檔
- [ ] 更新 `CONTRACT_ADDRESSES.md`
- [ ] 創建部署記錄：`DEPLOYMENT_RECORD_YYYY-MM-DD.md`
- [ ] 更新 README（如需要）
- [ ] 更新 CLAUDE.md（如需要）

### 14. 發布說明
- [ ] 編寫版本發布說明
- [ ] 列出主要變更
- [ ] 記錄已知問題

## ✅ 部署後驗證

### 15. 功能驗證
- [ ] 完整測試所有核心功能
- [ ] 監控交易是否正常
- [ ] 檢查 gas 使用情況
- [ ] 確認事件正確發出

### 16. 監控
- [ ] 設置錯誤告警
- [ ] 監控合約餘額
- [ ] 追踪用戶反饋

## 🚨 回滾計劃

### 17. 準備回滾
- [ ] 記錄回滾步驟
- [ ] 準備舊版本配置
- [ ] 確認回滾權限

## 📌 備註

### 特殊注意事項：
```
（在此記錄任何特殊的部署注意事項）
```

### 問題記錄：
```
（記錄部署過程中遇到的問題和解決方案）
```

---

**簽核確認**  
部署完成時間：____-__-__ __:__  
確認人：_______